# TURN Server Nginx Configuration
# Add this to your nginx configuration

# TURN server UDP port 3478
upstream turn_server {
    server localhost:3478;
}

# TURN server TLS port 5349  
upstream turn_server_tls {
    server localhost:5349;
}

# For TURN server, you need to handle UDP traffic
# This requires nginx stream module or direct port forwarding

# Option 1: Direct port forwarding (recommended for TURN)
# Add these to your server's firewall/iptables:
# sudo ufw allow 3478/udp
# sudo ufw allow 3478/tcp  
# sudo ufw allow 5349/udp
# sudo ufw allow 5349/tcp
# sudo ufw allow 49152:65535/udp

# Option 2: If using nginx stream module, add to nginx.conf:
stream {
    upstream turn_backend {
        server localhost:3478;
    }
    
    server {
        listen 3478 udp;
        proxy_pass turn_backend;
        proxy_timeout 1s;
        proxy_responses 1;
    }
    
    server {
        listen 3478;
        proxy_pass turn_backend;
    }
    
    upstream turn_tls_backend {
        server localhost:5349;
    }
    
    server {
        listen 5349 udp;
        proxy_pass turn_tls_backend;
        proxy_timeout 1s;
        proxy_responses 1;
    }
    
    server {
        listen 5349;
        proxy_pass turn_tls_backend;
    }
}
